function renderizarMeuCard(dados, diasEstudados, estudeiHoje, datasSemana, todosParticipantes) {
    const nome = dados.profiles.nome_completo || 'Eu';
    
    // --- L√ìGICA DA FOTO (NOVO) ---
    const foto = dados.profiles.foto_url;
    let avatarHtml = '';
    if (foto && foto.length > 10) {
        avatarHtml = `<div class="avatar"><img src="${foto}" alt="Foto"></div>`;
    } else {
        const inicial = nome.charAt(0).toUpperCase();
        avatarHtml = `<div class="avatar">${inicial}</div>`;
    }
    // ----------------------------

    let htmlQuadradinhos = '';
    let qtdEstudos = 0;
    const hojeStr = new Date().toISOString().split('T')[0];
    const diaSemanaHoje = new Date().getDay();

    datasSemana.forEach(data => {
        let classe = '';
        if (diasEstudados.includes(data)) { classe = 'verde'; qtdEstudos++; }
        else if (data === hojeStr) { classe = 'hoje-vazio'; }
        htmlQuadradinhos += `<div class="dia-quadrado ${classe}" title="${data}"></div>`;
    });

    const pctDedicao = Math.round((qtdEstudos / 6) * 100);
    
    let btnEstudo = estudeiHoje 
        ? `<button class="btn-acao btn-estudar feito">‚úÖ Estudo de Hoje Registrado!</button>`
        : `<button class="btn-acao btn-estudar" onclick="registrarEstudo()">üìñ Registrar Estudo de Hoje</button>`;

    let status = dados.status_presenca || 'pendente';
    let botoesPresenca = '';

    const meuGrupo = todosParticipantes.filter(p => p.grupo === dados.grupo);
    let versosCalculados;

    if (diaSemanaHoje === 6 || diaSemanaHoje === 0) {
        versosCalculados = calcularVersosDinamicos({ ...dados, status_presenca: 'confirmado' }, meuGrupo, dados.faixa_versos);
        versosCalculados.classe = "revelado";
    } else {
        versosCalculados = calcularVersosDinamicos(dados, meuGrupo, dados.faixa_versos);
    }

    if (status === 'confirmado') {
        botoesPresenca = `<div class="status-box verde">‚úÖ Presen√ßa Confirmada! <button onclick="alterarStatus('${dados.id}', 'pendente')" class="btn-link" style="color:#155724">(Desfazer)</button></div>`;
    } else if (status === 'nao_vou') {
        botoesPresenca = `<div class="status-box vermelho">‚ùå Voc√™ informou que n√£o ir√°. <button onclick="alterarStatus('${dados.id}', 'pendente')" class="btn-link" style="color:#721c24">(Mudei de ideia)</button></div>`;
    } else {
        botoesPresenca = `
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button onclick="alterarStatus('${dados.id}', 'confirmado')" class="btn-acao" style="background:#28a745; flex:1;">‚úÖ Confirmar</button>
                <button onclick="alterarStatus('${dados.id}', 'nao_vou')" class="btn-acao" style="background:#dc3545; flex:1;">‚ùå N√£o irei</button>
            </div>`;
    }

    let statusClass = '';
    if(status === 'confirmado') statusClass = 'ok';
    if(status === 'nao_vou') statusClass = 'no';

    const html = `
        <div class="dashboard-card" style="border: 2px solid #89b4fa;">
            <div class="status-presenca ${statusClass}"></div>
            <span class="grupo-badge">GRUPO ${dados.grupo}</span>
            <div class="card-content">
                <div class="perfil-area">
                    ${avatarHtml} <div class="info-nome"><div>${nome}</div>
                        <div class="dedicacao-area">${htmlQuadradinhos}</div>
                    </div>
                </div>
                <div class="verso-box ${versosCalculados.classe}">
                    <small>${versosCalculados.detalhe}</small>
                    <strong>${versosCalculados.texto}</strong>
                </div>
                <div class="grafico-area">
                    <div class="donut-chart" style="background: conic-gradient(#ff9800 0% ${pctDedicao}%, #e0e0e0 ${pctDedicao}%);">
                        <div class="donut-hole"></div>
                    </div>
                    <span class="porcentagem-texto">${pctDedicao}%</span>
                </div>
            </div>
            <div style="width:100%">
                ${btnEstudo}
                ${botoesPresenca}
            </div>
        </div>`;
    document.getElementById('meu-painel').innerHTML = html;
}
